<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta
      name="viewport"
      content="width=device-width,initial-scale=1.0,maximum-scale=1.0"
    />
    <link rel="icon" href="<%= BASE_URL %>favicon.ico" />
    <title>学长学姐帮帮忙</title>
    <script>
      // 新生
      // const token =
      //   'eyJhbGciOiJIUzI1NiJ9.eyJyb2xlIjoxLCJqdGkiOiIyMDE4MjExMjU5IiwiZXhwIjoxNTk3NzMxMTQ1LCJzdWIiOiJ7XCJzdHVOdW1cIjoyMDE4MjExMjU5fSIsImlhdCI6MTU5NzEyNjM0NSwic3R1TnVtIjoiMjAxODIxMTI1OSJ9.wkquOl-osHvf7G3bmnK3AfjBLgfvTdIN2hVMHGsvFuY';
      //志愿者
      // const token =
      //   'eyJhbGciOiJIUzI1NiJ9.eyJyb2xlIjowLCJqdGkiOiIyMDE4MjEyODIyIiwiZXhwIjoxNTk3NzI4NjgzLCJzdWIiOiJ7XCJzdHVOdW1cIjoyMDE4MjEyODIyfSIsImlhdCI6MTU5NzEyMzg4Mywic3R1TnVtIjoiMjAxODIxMjgyMiJ9.3YcjIPEMbjZiwsJ14QQXkJoqDaxlFsPaJHIedYXMXVM';
      const token = document.location.href.split('token=')[1];
      if (token && token.length) {
        document.location.hash = '#/';
        localStorage.setItem('id_token', token);
        const { exp, stuNum, role } = JSON.parse(atob(token.split('.')[1]));
        localStorage.setItem('exp', exp);
        localStorage.setItem('stuNum', stuNum);
        localStorage.setItem('role', role);
      }
      if (
        (!localStorage.getItem('id_token') ||
          parseInt(localStorage.getItem('exp')) <
            Math.floor(Date.now() / 1000) + 60 * 60 * 24 * 2) &&
        !token
      ) {
        window.location.href =
          'https://wx.redrock.team/magicloop/rushb?b=' +
          encodeURI('https://wx.redrock.team/wxapi/seniorhelpme2020/enter') +
          '&scope=student';
      }
    </script>
    <script>
      /* 百度统计代码 */
      var _hmt = _hmt || [];
      (function() {
        var hm = document.createElement('script');
        hm.src = 'https://hm.baidu.com/hm.js?21539512a892219bc8d4c9745677c786';
        var s = document.getElementsByTagName('script')[0];
        s.parentNode.insertBefore(hm, s);
        /* 下面的代码非常重要！！！ 文档：https://tongji.baidu.com/web/help/article?id=324&type=0 */
        _hmt.push([
          '_requirePlugin',
          'UrlChangeTracker',
          {
            shouldTrackUrlChange: function(newPath, oldPath) {
              return newPath && oldPath;
            },
          },
        ]);
      })();
    </script>
    <!-- built files will be auto injected -->
  </head>

  <body>
    <noscript>
      <strong>
        We're sorry but redrock-help-2019 doesn't work properly without
        JavaScript enabled. Please enable it to continue.
      </strong>
    </noscript>
    <div id="app"></div>
  </body>
  <script src="https://res.wx.qq.com/open/js/jweixin-1.6.0.js"></script>
  <script src="https://wx.idsbllp.cn/wx-api/share.js"></script>
  <script>
    WXSHARE.config({
      debug: false,
      jsApiList: ['updateAppMessageShareData', 'updateTimelineShareData'],
    });
    WXSHARE.ready(function() {
      var option = {
        title: '学长学姐帮帮忙',
        link: 'https://wx.redrock.team/game/xzxjbbm2020/',
        imgUrl:
          'https://static01.imgkr.com/temp/7de92f1ef0c14ce5b2d9a311e7c416c5.jpg',
        desc: '有问题，就找学长学姐！',
        type: '',
        success: function() {
          console.log('分享成功');
        },
        cancel: function() {
          console.log('取消分享');
        },
      };
      wx.updateAppMessageShareData(option);
      wx.updateTimelineShareData(option);
    });
  </script>
</html>
